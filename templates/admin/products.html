{% extends "base.html" %}

{% block title %}Products - Admin - Motion{% endblock %}

{% block content %}
<section class="admin-section">
    <div class="container">
        <div class="admin-header">
            <div>
                <h1>Product Management</h1>
                <p>Manage your product catalog</p>
            </div>
            <div class="admin-nav">
                <a href="{{ url_for('admin_dashboard') }}" class="admin-nav-link">Dashboard</a>
                <a href="{{ url_for('admin_orders') }}" class="admin-nav-link">Orders</a>
                <a href="{{ url_for('admin_quotes') }}" class="admin-nav-link">Quotes</a>
                <a href="{{ url_for('admin_products') }}" class="admin-nav-link active">Products</a>
                <a href="{{ url_for('admin_users') }}" class="admin-nav-link">Users</a>
            </div>
        </div>
        
        <div class="actions-bar">
            <a href="{{ url_for('admin_add_product') }}" class="btn btn-primary">
                <i class="fas fa-plus"></i> Add Product
            </a>
        </div>
        
        {% for category in categories %}
        <div class="category-section">
            <h2><i class="{{ category.icon }}"></i> {{ category.name }}</h2>
            
            {% set cat_products = products | selectattr('category_id', 'equalto', category.id) | list %}
            {% if cat_products %}
            <div class="products-table">
                <table>
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Base Price</th>
                            <th>Min Qty</th>
                            <th>Status</th>
                            <th>Options</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for product in cat_products %}
                        <tr>
                            <td>
                                <strong>{{ product.name }}</strong>
                                <small class="slug">{{ product.slug }}</small>
                            </td>
                            <td>UGX {{ "{:,.0f}".format(product.base_price) }}</td>
                            <td>{{ product.min_quantity }}</td>
                            <td>
                                <span class="status-dot {% if product.is_active %}active{% else %}inactive{% endif %}"></span>
                                {{ 'Active' if product.is_active else 'Inactive' }}
                            </td>
                            <td>
                                {% if product.size_options %}<span class="option-badge">Sizes</span>{% endif %}
                                {% if product.material_options %}<span class="option-badge">Materials</span>{% endif %}
                                {% if product.color_options %}<span class="option-badge">Colors</span>{% endif %}
                                {% if product.finishing_options %}<span class="option-badge">Finishing</span>{% endif %}
                            </td>
                            <td>
                                <a href="{{ url_for('shop_product', slug=product.slug) }}" target="_blank" class="btn-action" title="View">
                                    <i class="fas fa-eye"></i>
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <p class="empty-category">No products in this category yet.</p>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</section>
{% endblock %}

{% block extra_css %}
<style>
    .admin-section {
        padding: 100px 20px 60px;
        background: #f0f2f5;
    }
    
    .admin-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
        flex-wrap: wrap;
        gap: 20px;
    }
    
    .admin-header h1 {
        margin-bottom: 5px;
    }
    
    .admin-header p {
        color: var(--text-light);
    }
    
    .admin-nav {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
    }
    
    .admin-nav-link {
        padding: 10px 20px;
        border-radius: 8px;
        background: var(--white);
        color: var(--text-color);
        font-weight: 500;
        transition: var(--transition);
    }
    
    .admin-nav-link:hover,
    .admin-nav-link.active {
        background: var(--primary-color);
        color: var(--white);
    }
    
    .actions-bar {
        margin-bottom: 30px;
    }
    
    .category-section {
        background: white;
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 25px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    .category-section h2 {
        font-size: 1.2rem;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 2px solid var(--light-bg);
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .category-section h2 i {
        color: var(--secondary-color);
    }
    
    .products-table {
        overflow-x: auto;
    }
    
    .products-table table {
        width: 100%;
        border-collapse: collapse;
    }
    
    .products-table th,
    .products-table td {
        padding: 15px;
        text-align: left;
        border-bottom: 1px solid var(--border-color);
    }
    
    .products-table th {
        font-weight: 600;
        color: var(--text-light);
        font-size: 0.85rem;
        text-transform: uppercase;
    }
    
    .products-table tr:last-child td {
        border-bottom: none;
    }
    
    .slug {
        display: block;
        color: var(--text-light);
        font-size: 0.8rem;
    }
    
    .status-dot {
        display: inline-block;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        margin-right: 5px;
    }
    
    .status-dot.active {
        background: #28a745;
    }
    
    .status-dot.inactive {
        background: #dc3545;
    }
    
    .option-badge {
        display: inline-block;
        padding: 2px 8px;
        background: var(--light-bg);
        border-radius: 10px;
        font-size: 0.75rem;
        margin-right: 5px;
    }
    
    .btn-action {
        padding: 8px;
        color: var(--text-light);
    }
    
    .btn-action:hover {
        color: var(--secondary-color);
    }
    
    .empty-category {
        color: var(--text-light);
        text-align: center;
        padding: 20px;
    }
</style>
{% endblock %}

